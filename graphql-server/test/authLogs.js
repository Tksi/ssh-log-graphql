import { gql } from 'graphql-request';
import { assertGraphql } from './lib/assertGraphql.js';

describe('authLogs', () => {
  it('range: { from: "2021/11/29", to: "2021/11/29 0:10" }', async () => {
    await assertGraphql(
      gql`
        query {
          authLogs(range: { from: "2021/11/29", to: "2021/11/29 0:10" }) {
            sshdHost
            result
            user
            password
            ip
            port
            authtime
            detect
            rtt
            unixtime
            usec
            kex
            newkey
            date
            organizationName
            continentCode
            country
            countryCode
            countryCode3
            city
            longitude
            latitude
            asn
          }
        }
      `,
      {
        data: {
          authLogs: [
            {
              sshdHost: 'example.com',
              result: 'Fail',
              user: 'root',
              password: '1472588564',
              ip: '76.176.69.186',
              port: 35542,
              authtime: 0.15048,
              detect: 'Normal',
              rtt: 348.621626,
              unixtime: 1638111618,
              usec: 244229,
              kex: 559.827194,
              newkey: 137.416059,
              date: '2021/11/29 0:00:18',
              organizationName: 'TWC-20001-PACWEST',
              continentCode: 'NA',
              country: 'United States',
              countryCode: 'US',
              countryCode3: 'USA',
              city: 'San Diego',
              longitude: -117.1202,
              latitude: 32.9661,
              asn: 20001,
            },
            {
              sshdHost: 'example.com',
              result: 'Fail',
              user: 'ybr',
              password: 'ybr',
              ip: '186.67.248.8',
              port: 40484,
              authtime: 0.317832,
              detect: 'Normal',
              rtt: -211.05276,
              unixtime: 1638111689,
              usec: 927459,
              kex: 288.235998,
              newkey: -710.341518,
              date: '2021/11/29 0:01:29',
              organizationName: 'ENTEL CHILE S.A.',
              continentCode: 'SA',
              country: 'Chile',
              countryCode: 'CL',
              countryCode3: 'CHL',
              city: 'Maipu',
              longitude: -70.7694,
              latitude: -33.5172,
              asn: 27651,
            },
            {
              sshdHost: 'example.com',
              result: 'Fail',
              user: 'root',
              password: 'tang520@!~',
              ip: '124.160.96.249',
              port: 39893,
              authtime: 0.067401,
              detect: 'Normal',
              rtt: 0.062113,
              unixtime: 1638111831,
              usec: 883556,
              kex: 0.061991,
              newkey: 0.062235,
              date: '2021/11/29 0:03:51',
              organizationName: 'CHINA UNICOM China169 Backbone',
              continentCode: 'AS',
              country: 'China',
              countryCode: 'CN',
              countryCode3: 'CHN',
              city: 'Hangzhou',
              longitude: 120.1612,
              latitude: 30.2994,
              asn: 4837,
            },
            {
              sshdHost: 'example.com',
              result: 'Fail',
              user: 'root',
              password: 'EXFLASH',
              ip: '116.153.2.143',
              port: 58970,
              authtime: 0.088023,
              detect: 'Normal',
              rtt: 68.0827,
              unixtime: 1638111890,
              usec: 292031,
              kex: 67.513245,
              newkey: 68.652156,
              date: '2021/11/29 0:04:50',
              organizationName: 'CHINA UNICOM China169 Backbone',
              continentCode: 'AS',
              country: 'China',
              countryCode: 'CN',
              countryCode3: 'CHN',
              city: null,
              longitude: 113.722,
              latitude: 34.7732,
              asn: 4837,
            },
            {
              sshdHost: 'example.com',
              result: 'Fail',
              user: 'root',
              password: '159357uu',
              ip: '159.65.150.106',
              port: 40142,
              authtime: 0.129279,
              detect: 'Normal',
              rtt: 0.123203,
              unixtime: 1638111905,
              usec: 657144,
              kex: 0.123065,
              newkey: 0.123342,
              date: '2021/11/29 0:05:05',
              organizationName: 'DIGITALOCEAN-ASN',
              continentCode: 'AS',
              country: 'India',
              countryCode: 'IN',
              countryCode3: 'IND',
              city: 'Bengaluru',
              longitude: 77.5855,
              latitude: 12.9634,
              asn: 14061,
            },
            {
              sshdHost: 'example.com',
              result: 'Fail',
              user: 'root',
              password: 'res1!+',
              ip: '94.232.46.202',
              port: 40064,
              authtime: 0.278317,
              detect: 'Normal',
              rtt: 256.316066,
              unixtime: 1638111937,
              usec: 834946,
              kex: 255.520908,
              newkey: 257.111224,
              date: '2021/11/29 0:05:37',
              organizationName: 'Belcloud LTD',
              continentCode: 'EU',
              country: 'Russia',
              countryCode: 'RU',
              countryCode3: 'RUS',
              city: 'Perm',
              longitude: 56.2397,
              latitude: 58.0041,
              asn: 44901,
            },
            {
              sshdHost: 'example.com',
              result: 'Fail',
              user: 'root',
              password: 'hxfxhfdx',
              ip: '76.176.69.186',
              port: 38354,
              authtime: 0.146309,
              detect: 'Normal',
              rtt: 335.6449,
              unixtime: 1638111984,
              usec: 219162,
              kex: 544.802218,
              newkey: 126.487582,
              date: '2021/11/29 0:06:24',
              organizationName: 'TWC-20001-PACWEST',
              continentCode: 'NA',
              country: 'United States',
              countryCode: 'US',
              countryCode3: 'USA',
              city: 'San Diego',
              longitude: -117.1202,
              latitude: 32.9661,
              asn: 20001,
            },
            {
              sshdHost: 'example.com',
              result: 'Fail',
              user: 'root',
              password: '%#@!',
              ip: '186.67.248.8',
              port: 37108,
              authtime: 0.304035,
              detect: 'Normal',
              rtt: -217.190116,
              unixtime: 1638112014,
              usec: 478608,
              kex: -717.070932,
              newkey: 282.690699,
              date: '2021/11/29 0:06:54',
              organizationName: 'ENTEL CHILE S.A.',
              continentCode: 'SA',
              country: 'Chile',
              countryCode: 'CL',
              countryCode3: 'CHL',
              city: 'Maipu',
              longitude: -70.7694,
              latitude: -33.5172,
              asn: 27651,
            },
            {
              sshdHost: 'example.com',
              result: 'Fail',
              user: 'root',
              password: 'admin520',
              ip: '124.160.96.249',
              port: 3278,
              authtime: 0.071692,
              detect: 'Normal',
              rtt: 0.061105,
              unixtime: 1638112162,
              usec: 746196,
              kex: 0.059698,
              newkey: 0.062512,
              date: '2021/11/29 0:09:22',
              organizationName: 'CHINA UNICOM China169 Backbone',
              continentCode: 'AS',
              country: 'China',
              countryCode: 'CN',
              countryCode3: 'CHN',
              city: 'Hangzhou',
              longitude: 120.1612,
              latitude: 30.2994,
              asn: 4837,
            },
          ],
        },
      }
    );
  });
});
